// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.27.0
// source: company.sql

package database

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const checkDeviceExistInCompany = `-- name: CheckDeviceExistInCompany :one
SELECT d.name
FROM devices d
WHERE d.company_id = $1
  AND d.device_id = $2
`

type CheckDeviceExistInCompanyParams struct {
	CompanyID pgtype.UUID
	DeviceID  pgtype.UUID
}

func (q *Queries) CheckDeviceExistInCompany(ctx context.Context, arg CheckDeviceExistInCompanyParams) (string, error) {
	row := q.db.QueryRow(ctx, checkDeviceExistInCompany, arg.CompanyID, arg.DeviceID)
	var name string
	err := row.Scan(&name)
	return name, err
}

const checkUserIsManagementInCompany = `-- name: CheckUserIsManagementInCompany :one
SELECT e.employee_code
FROM employees e
JOIN users u ON e.employee_id = u.user_id
WHERE e.company_id = $1
  AND e.employee_id = $2
  AND u.role < 2
`

type CheckUserIsManagementInCompanyParams struct {
	CompanyID  pgtype.UUID
	EmployeeID pgtype.UUID
}

func (q *Queries) CheckUserIsManagementInCompany(ctx context.Context, arg CheckUserIsManagementInCompanyParams) (string, error) {
	row := q.db.QueryRow(ctx, checkUserIsManagementInCompany, arg.CompanyID, arg.EmployeeID)
	var employee_code string
	err := row.Scan(&employee_code)
	return employee_code, err
}

const deleteDeviceSessionByID = `-- name: DeleteDeviceSessionByID :exec
UPDATE devices
SET token = NULL,
    updated_at = NOW()
WHERE device_id = $1
`

func (q *Queries) DeleteDeviceSessionByID(ctx context.Context, deviceID pgtype.UUID) error {
	_, err := q.db.Exec(ctx, deleteDeviceSessionByID, deviceID)
	return err
}

const disableDevice = `-- name: DisableDevice :exec
UPDATE devices
SET is_active = FALSE,
    updated_at = NOW()
WHERE device_id = $1
`

func (q *Queries) DisableDevice(ctx context.Context, deviceID pgtype.UUID) error {
	_, err := q.db.Exec(ctx, disableDevice, deviceID)
	return err
}

const getCompanyUser = `-- name: GetCompanyUser :one
SELECT 
    company_id
FROM employees
WHERE employee_id = $1
LIMIT 1
`

func (q *Queries) GetCompanyUser(ctx context.Context, employeeID pgtype.UUID) (pgtype.UUID, error) {
	row := q.db.QueryRow(ctx, getCompanyUser, employeeID)
	var company_id pgtype.UUID
	err := row.Scan(&company_id)
	return company_id, err
}

const updateDeviceSession = `-- name: UpdateDeviceSession :exec
UPDATE devices
SET token = $2,
    updated_at = NOW()
WHERE device_id = $1
`

type UpdateDeviceSessionParams struct {
	DeviceID pgtype.UUID
	Token    string
}

func (q *Queries) UpdateDeviceSession(ctx context.Context, arg UpdateDeviceSessionParams) error {
	_, err := q.db.Exec(ctx, updateDeviceSession, arg.DeviceID, arg.Token)
	return err
}
