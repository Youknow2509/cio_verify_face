sequenceDiagram
    autonumber
    participant Admin as Admin/Manager
    participant Gateway as API Gateway
    box Analytics Engine #fff8e1
        participant Analytics as Analytics Service
        participant Cache as Smart Cache
    end
    participant Data as Data Warehouse

    Admin->>+Gateway: GET /reports/daily?date=2024-01-15
    Gateway->>Gateway: Validate Admin Token
    
    Gateway->>+Analytics: Request Daily Report
    
    Analytics->>+Cache: Check Cached Report
    Note right of Cache: Key: daily_report:{company}:{date}
    
    alt Cache Hit
        Cache-->>Analytics: Return Cached Report
        Analytics-->>Gateway: Daily Report (Cached)
    else Cache Miss
        Cache-->>-Analytics: Not Found
        
        par Parallel Data Aggregation
            Analytics->>+Data: Query Attendance Records
            Note right of Data: Time-series DB query<br/>Partition: date + company_id
            Data-->>-Analytics: Raw Attendance Data
        and
            Analytics->>+Data: Query Employee Schedules
            Data-->>-Analytics: Expected Schedules
        end
        
        Analytics->>Analytics: Process & Calculate Metrics
        Note right of Analytics: • Total Check-ins/Outs<br/>• Late Arrivals<br/>• Early Departures<br/>• Absences<br/>• Work Hour Summaries
        
        par Finalize Report
            Analytics->>Cache: Cache Report (TTL: 6h)
        and
            Analytics-->>-Gateway: Generated Report
        end
    end
    
    Gateway-->>-Admin: Daily Attendance Report